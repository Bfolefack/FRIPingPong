<?xml version="1.0" ?>
<robot name="sawyer_pong_system" xmlns:xacro="http://www.ros.org/wiki/xacro">

  <xacro:arg name="gazebo" default="false"/>
  <xacro:arg name="pedestal" default="true"/>
  <xacro:arg name="static" default="true"/>
  <xacro:arg name="electric_gripper" default="false"/>
  <!-- Sawyer Base URDF -->
  <xacro:include filename="$(find sawyer_description)/urdf/sawyer_base.urdf.xacro">
    <xacro:arg name="gazebo" value="${gazebo}"/>
    <xacro:arg name="pedestal" value="${pedestal}"/>
  </xacro:include>
  <xacro:if value="$(arg gazebo)">
  <xacro:include filename="$(find sawyer_description)/urdf/sawyer_base.gazebo.xacro">
    <xacro:arg name="static" value="${static}"/>
    <xacro:arg name="pedestal" value="${pedestal}"/>
  </xacro:include>
  </xacro:if>
  <!-- Electric Gripper End Effector -->
  <xacro:if value="$(arg electric_gripper)">
  <xacro:include filename="$(find sawyer_description)/urdf/sawyer_electric_gripper.urdf.xacro">
    <xacro:arg name="gazebo" value="${gazebo}"/>
  </xacro:include>
  </xacro:if>


<!--                                  THE FOLLOWING ARE THE PING PONG SYSTEM LINKS: ball_link paddle_link table_link                        -->
<!--                                                                                                                                        -->
<!--                                                                                                                                        -->
<!--                                                                                                                                        -->

<!-- World Link -->
<link name="world" />

<!-- Ping Pong Ball Link -->
    <link name="ball_link">
        <visual>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <!-- Define a spherical shape -->
            <geometry>
                <sphere radius="0.02"/>
            </geometry>

            <material>

            </material>
        </visual>

        <collision>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <geometry>
                <sphere radius="0.02"/>
            </geometry>
            <surface>
                <bounce restitution_coefficient="1.0" threshold="0"/>
            </surface>
        </collision>

        <inertial>
            <mass value="0.0027"/>
            <origin xyz="0 0 0" rpy="0 0 0"/> <!-- Center of mass -->
            <!-- Approximate values given a hollow sphere -->
            <inertia ixx="0.0000075" ixy="0" ixz="0" iyy="0.0000075" iyz="0" izz="0.0000075"/>
        </inertial>
    </link>

<!-- Ping Pong Paddle Link -->
    <link name="paddle_link">
      <inertial>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <mass value="0.085"/>
          <inertia ixx="0.002858" ixy="0" ixz="0" iyy="0.002987" iyz="0" izz="0.0001420" /> <!-- ${0.08333333333*plate_mass*plate_width}-->
      </inertial>
      <visual>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://pong_gazebo_pkg/models/paddle/paddle.stl"/>
          </geometry>
      </visual>
      <collision>
          <origin xyz="0 0 0" rpy="0 0 0"/>
          <geometry>
            <mesh filename="package://pong_gazebo_pkg/models/paddle/paddle.stl"/>
          </geometry>
          <surface>
            <bounce restitution_coefficient="0.1" threshold="0.01" />
          </surface>
      </collision>
    </link>



<!-- Table Link -->
    <link name="table_link">
        <visual>
            <geometry>
                <mesh filename="package://ping_pong_gazebo/models/table/table.stl"/>
            </geometry>

            <origin xyz="0 0 0" rpy="0 0 0" />

            <material>
                <diffuse>0 0 0.75 1</diffuse>
                <script>
                    <uri>file://ping_pong_gazebo/models/table/table.dae</uri>
                    <name>Gazebo/Table</name>
                </script>
            </material>

            <material>
            </material>
        </visual>


        <collision>
            <geometry>
                <mesh filename="package://ping_pong_gazebo/models/table/table.stl"/>
            </geometry>


            <surface>
                <bounce> restitution_coefficient="0.8" </bounce>
            </surface>


            <origin xyz="0 0 0" rpy="0 0 0" />
            <material>
                <diffuse>0 0 0.75 1</diffuse>
                <script>
                    <uri>file://ping_pong_gazebo/models/table/table.dae</uri>
                    <name>Gazebo/Table</name>
                </script>
            </material>
        </collision>

        <!-- Inertial field doesn't actually matter since the table is fixed -->
        <inertial>
            <mass/>
            <origin/>
            <inertia/>
        </inertial>
    </link>



<!--                                            THE FOLLOWING ARE THE PING PONG SYSTEM JOINTS:                                              -->
<!--                                                                                                                                        -->
<!--                                                                                                                                        -->
<!--                                                                                                                                        -->

    <joint name="world_to_table_joint" type="fixed">
        <parent link="world"/>
        <child link="table_link"/>
        <origin xyz="0 0 0" rpy="0 0 0" />
    </joint>

    <joint name="world_to_ball_joint" type="floating" >
        <parent link="world"/>
        <child link="world_link"/>
        <origin xyz="0 0 0.5" rpy="0 0 0" />
    </joint>

    <joint name="electric_gripper_to_paddle_joint" type="fixed" >
        <parent link="rethink_electric_gripper"/>
        <child link="paddle"/>
        <origin xyz="0 0 0.1" rpy="0 0 0" />
    </joint>

</robot>